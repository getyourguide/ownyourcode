{"version":3,"file":"index.js","sources":["../src/github-service.ts","../src/utils.ts","../src/codeowners.ts","../src/handlers/pr-handler.ts","../src/handlers/branch-handler.ts","../src/main.ts","../src/index.ts"],"sourcesContent":["import type { Octokit } from \"./main.ts\";\n\nexport class GitHubService {\n  constructor(\n    private octokit: Octokit,\n    private owner: string,\n    private repo: string,\n  ) {}\n\n  async getCodeOwnersFile(ref: string, filePath: string): Promise<string> {\n    try {\n      const { data } = await this.octokit.rest.repos.getContent({\n        owner: this.owner,\n        repo: this.repo,\n        ref,\n        path: filePath,\n      });\n      if (Array.isArray(data) || data.type !== \"file\") {\n        throw new Error(`File not found or is not a regular file: ${filePath}`);\n      }\n      const content = Buffer.from(data.content, \"base64\").toString(\"utf-8\");\n      return content;\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    } catch (_) {\n      throw new Error(\n        `Error reading the CODEOWNERS file ${this.owner}/${this.repo}/${filePath}\\nMake sure the file exists and the github token has access to the repo`,\n      );\n    }\n  }\n\n  async getChangedFiles(prNumber: number): Promise<string[]> {\n    const filesList = [];\n    const iterator = this.octokit.paginate.iterator(\n      this.octokit.rest.pulls.listFiles,\n      {\n        owner: this.owner,\n        repo: this.repo,\n        pull_number: prNumber,\n        per_page: 100,\n      },\n    );\n\n    for await (const { data: files } of iterator) {\n      for (const file of files) {\n        if (file.status !== \"removed\") filesList.push(file.filename);\n      }\n    }\n\n    return filesList;\n  }\n\n  async getAllFiles(branch: string): Promise<string[]> {\n    const { data } = await this.octokit.rest.git.getTree({\n      recursive: \"true\",\n      owner: this.owner,\n      repo: this.repo,\n      tree_sha: `refs/heads/${branch}`,\n    });\n\n    const files: string[] = [];\n\n    data.tree.forEach(node => {\n      if (node.type === \"blob\" && node.path) {\n        files.push(node.path);\n      }\n    });\n\n    return files;\n  }\n\n  async createComment(prNumber: number, body: string): Promise<void> {\n    const payload = {\n      repo: this.repo,\n      owner: this.owner,\n      issue_number: prNumber,\n      body,\n    };\n    await this.octokit.rest.issues.createComment(payload);\n  }\n\n  async updateComment(commentId: number, body: string): Promise<void> {\n    const payload = {\n      repo: this.repo,\n      owner: this.owner,\n      comment_id: commentId,\n      body,\n    };\n    await this.octokit.rest.issues.updateComment(payload);\n  }\n\n  async findPreviousComment(prNumber: number, commentHeader: string) {\n    const { data } = await this.octokit.rest.issues.listComments({\n      repo: this.repo,\n      owner: this.owner,\n      per_page: 100,\n      issue_number: prNumber,\n    });\n    const comment = data.find(comment =>\n      comment.body?.startsWith(commentHeader),\n    );\n    return comment ? { id: comment.id, content: comment.body } : undefined;\n  }\n}\n","export function escapeRegex(str: string): string {\n  return str.replace(/[/\\-\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\n}\n","import globToRegExp from \"glob-to-regexp\";\nimport { escapeRegex } from \"./utils.ts\";\n\ntype Rule = [RegExp, string];\nexport class CodeOwners {\n  private ruleset: Rule[];\n  private codeownersPath: string;\n\n  constructor(codeowners: string, codeownersPath: string) {\n    this.ruleset = codeowners\n      .split(\"\\n\")\n      // split the line using spaces/tabs\n      .map(line => line.split(/\\s+/).filter(part => part))\n      // filter out comments, empty lines, and * rules\n      .filter(line => line[0] && line[0] !== \"#\" && line[0] !== \"*\")\n      // convert glob to regexp\n      .map(line => {\n        const [glob, owner] = line;\n        // Remove the / at the start of the globs\n        const globNoSlash = glob.replace(/^\\/+/, \"\");\n        const regexp = globToRegExp(globNoSlash, {\n          globstar: true,\n          extended: true,\n          flags: \"g\",\n        });\n\n        return [regexp, owner];\n      });\n\n    this.codeownersPath = escapeRegex(codeownersPath);\n  }\n\n  isCovered(filePath: string): boolean {\n    // skip CODEOWNERS file\n    if (filePath.match(this.codeownersPath)) return true;\n\n    return this.ruleset.some(rule => {\n      if (!rule?.[0]) return false;\n\n      return filePath.match(rule[0]);\n    });\n  }\n\n  bulkIsCovered(filePaths: string[]): boolean[] {\n    return filePaths.map(filePath => this.isCovered(filePath));\n  }\n}\n","import type { GitHubService } from \"../github-service.ts\";\nimport type { Handler } from \"./index.ts\";\n\nconst COMMENT_HEADER = \"## OwnYourCode\\n\";\n\nexport class PrHandler implements Handler {\n  constructor(\n    private githubService: GitHubService,\n    private prNumber: number,\n  ) {}\n\n  async getCodeOwnersFile(filePath: string) {\n    const ref = `pull/${this.prNumber}/head`;\n    return await this.githubService.getCodeOwnersFile(ref, filePath);\n  }\n\n  async getChangedFiles() {\n    return await this.githubService.getChangedFiles(this.prNumber);\n  }\n\n  async createOrUpdatePrComment(noOwnerArr: string[]) {\n    const prevComment = await this.githubService.findPreviousComment(\n      this.prNumber,\n      COMMENT_HEADER,\n    );\n\n    if (prevComment) {\n      await this.githubService.updateComment(\n        prevComment.id,\n        this.buildCommentBody(noOwnerArr),\n      );\n    }\n    if (noOwnerArr.length && !prevComment) {\n      await this.githubService.createComment(\n        this.prNumber,\n        this.buildCommentBody(noOwnerArr),\n      );\n    }\n  }\n\n  buildCommentBody(files: string[]) {\n    if (!files.length) {\n      return `${COMMENT_HEADER}✅ All files have an owner in the CODEOWNERS file. Good job!`;\n    }\n\n    return `${COMMENT_HEADER}❌ The following files do not have an owner in the CODEOWNERS file:\\n* ${files.join(\n      \"\\n* \",\n    )}\\n\\n**Please assign an owner to these files.**`;\n  }\n}\n","import type { GitHubService } from \"../github-service.ts\";\nimport type { Handler } from \"./index.ts\";\n\nexport class BranchHandler implements Handler {\n  constructor(\n    private githubService: GitHubService,\n    private branch: string,\n  ) {}\n\n  async getCodeOwnersFile(filePath: string) {\n    const ref = `refs/heads/${this.branch}`;\n    return await this.githubService.getCodeOwnersFile(ref, filePath);\n  }\n\n  async getChangedFiles() {\n    return await this.githubService.getAllFiles(this.branch);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  async createOrUpdatePrComment(_noOwnerArr: string[]) {\n    return Promise.resolve();\n  }\n}\n","import {\n  setFailed,\n  getInput,\n  getBooleanInput,\n  setOutput,\n  info,\n} from \"@actions/core\";\nimport { context as ghContext, getOctokit } from \"@actions/github\";\nimport { GitHubService } from \"./github-service.ts\";\nimport { CodeOwners } from \"./codeowners.ts\";\nimport { BranchHandler, PrHandler } from \"./handlers/index.ts\";\n\nexport type Octokit = ReturnType<typeof getOctokit>;\n\nexport async function run() {\n  try {\n    const { githubToken, codeownersPath, prNumber, failOnMissing, branch } =\n      loadInputs();\n\n    const { repo, owner } = ghContext.repo;\n    const Octokit = getOctokit(githubToken);\n    const githubService = new GitHubService(Octokit, owner, repo);\n\n    welcomeMessage(repo, codeownersPath, failOnMissing, branch, prNumber);\n\n    const handler = prNumber\n      ? new PrHandler(githubService, prNumber)\n      : new BranchHandler(githubService, branch);\n    const codeownersFile = await handler.getCodeOwnersFile(codeownersPath);\n    const changedFiles = await handler.getChangedFiles();\n    const codeowners = new CodeOwners(codeownersFile, codeownersPath);\n\n    const { noOwnerArr, failed } = checkFilesOwners(\n      changedFiles,\n      codeowners,\n      failOnMissing,\n    );\n\n    await handler.createOrUpdatePrComment(noOwnerArr);\n\n    setOutput(\"total_scanned_files\", changedFiles.length);\n    setOutput(\"total_orphan_files\", noOwnerArr.length);\n    setOutput(\"failed\", failed);\n  } catch (error) {\n    setFailed(`OwnYourCode action failed: ${(error as Error).message}`);\n  }\n}\n\nfunction loadInputs() {\n  const githubToken: string = getInput(\"GITHUB_TOKEN\");\n  const codeownersPath: string = getInput(\"CODEOWNERS_PATH\");\n  const prNumber: number | undefined = +getInput(\"PR_NUMBER\");\n  const branch: string | undefined = getInput(\"BRANCH\");\n  const failOnMissing: boolean = getBooleanInput(\"FAIL_ON_MISSING_CODEOWNERS\");\n\n  return { githubToken, codeownersPath, prNumber, failOnMissing, branch };\n}\n\nfunction welcomeMessage(\n  repo: string,\n  codeownersPath: string,\n  failOnMissing: boolean,\n  branch?: string,\n  prNumber?: number,\n) {\n  info(`----------- OwnYourCode ----------`);\n  info(`Repo: ${repo}`);\n  info(`File: ${codeownersPath}`);\n  info(`Fail on missing: ${failOnMissing}`);\n  info(\n    `Mode: ${prNumber ? \"Check PR changed files\" : \"Check all branch files\"}`,\n  );\n  branch && info(`Branch: ${branch}`);\n  prNumber && info(`PR: #${prNumber}`);\n  info(`----------------------------------\\n`);\n}\n\nfunction checkFilesOwners(\n  files: string[],\n  codeowners: CodeOwners,\n  failOnMissingCodeowners: boolean,\n) {\n  let failed = false;\n  const isCoveredArr: string[] = [];\n  const noOwnerArr: string[] = [];\n\n  files.forEach(file => {\n    const isCovered = codeowners.isCovered(file);\n    isCovered ? isCoveredArr.push(file) : noOwnerArr.push(file);\n    failed = failed || !isCovered;\n  });\n\n  printResults(\"List of covered files ✅\", isCoveredArr);\n  printResults(\"List of files not covered ❌\", noOwnerArr);\n\n  if (failed && failOnMissingCodeowners) {\n    setFailed(\n      \"Some files do not have an owner, please define one in CODEOWNERS file\",\n    );\n  }\n\n  return { noOwnerArr, failed };\n}\n\nexport function printResults(title: string, files: string[]) {\n  if (!files.length) return;\n\n  info(title);\n  files.forEach(file => info(file));\n}\n","/**\n * The entrypoint for the action.\n */\nimport { run } from \"./main.ts\";\n\n// eslint-disable-next-line @typescript-eslint/no-floating-promises\nrun();\n"],"names":["ghContext"],"mappings":"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"}